CXXFLAGS=-Isrc/bptree -std=c++17 -DINMEMORY
TARGET=src/tree_analysis.cpp
EXE_DIR=trees

all: trees

trees: clean
	$(CXX) $(CXXFLAGS) -DBENCHMARK $(TARGET) -o $(EXE_DIR)/1_simple
	$(CXX) $(CXXFLAGS) -DTAIL_FAT -DBENCHMARK $(TARGET) -o $(EXE_DIR)/2_tail
	$(CXX) $(CXXFLAGS) -DLIL_FAT -DBENCHMARK $(TARGET) -o $(EXE_DIR)/3_lil
	$(CXX) $(CXXFLAGS) -DLOL_FAT -DBENCHMARK $(TARGET) -o $(EXE_DIR)/4_plainlol
	$(CXX) $(CXXFLAGS) -DLOL_FAT -DVARIABLE_SPLIT -DBENCHMARK $(TARGET) -o $(EXE_DIR)/5_lol_v
	$(CXX) $(CXXFLAGS) -DLOL_FAT -DVARIABLE_SPLIT -DDOUBLE_IQR -DBENCHMARK $(TARGET) -o $(EXE_DIR)/6_lol_vi
	$(CXX) $(CXXFLAGS) -DLOL_FAT -DVARIABLE_SPLIT -DDOUBLE_IQR -DREDISTRIBUTE -DBENCHMARK $(TARGET) -o $(EXE_DIR)/7_lol_vir
	$(CXX) $(CXXFLAGS) -DBENCHMARK $(TARGET) -O3 -o $(EXE_DIR)/1_O3_simple
	$(CXX) $(CXXFLAGS) -DTAIL_FAT -DBENCHMARK $(TARGET) -O3 -o $(EXE_DIR)/2_O3_tail
	$(CXX) $(CXXFLAGS) -DLIL_FAT -DBENCHMARK $(TARGET) -O3 -o $(EXE_DIR)/3_O3_lil
	$(CXX) $(CXXFLAGS) -DLOL_FAT -DBENCHMARK $(TARGET) -O3 -o $(EXE_DIR)/4_O3_plainlol
	$(CXX) $(CXXFLAGS) -DLOL_FAT -DVARIABLE_SPLIT -DBENCHMARK $(TARGET) -O3 -o $(EXE_DIR)/5_O3_lol_v
	$(CXX) $(CXXFLAGS) -DLOL_FAT -DVARIABLE_SPLIT -DDOUBLE_IQR -DBENCHMARK $(TARGET) -O3 -o $(EXE_DIR)/6_O3_lol_vi
	$(CXX) $(CXXFLAGS) -DLOL_FAT -DVARIABLE_SPLIT -DDOUBLE_IQR -DREDISTRIBUTE -DBENCHMARK $(TARGET) -O3 -o $(EXE_DIR)/7_O3_lol_vir

simple:
	$(CXX) $(CXXFLAGS) $(TARGET) -o $(EXE_DIR)/$@

tail:
	$(CXX) $(CXXFLAGS) -DTAIL_FAT $(TARGET) -o $(EXE_DIR)/$@

lil:
	$(CXX) $(CXXFLAGS) -DLIL_FAT $(TARGET) -o $(EXE_DIR)/$@

plainlol:
	$(CXX) $(CXXFLAGS) -DLOL_FAT $(TARGET) -o $(EXE_DIR)/$@

lol:
	$(CXX) $(CXXFLAGS) -DLOL_FAT -DVARIABLE_SPLIT -DDOUBLE_IQR -DREDISTRIBUTE -DLOL_RESET $(TARGET) -o $(EXE_DIR)/$@

clean:
	mkdir -p $(EXE_DIR)
	rm -f $(EXE_DIR)/*
